{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport JWTDecode from 'jwt-decode';\nimport { openAlert } from \"./AlertSlice\";\nimport axios from \"axios\";\nconst API = axios.create({\n  baseURL: `${process.env.REACT_APP_BASE_API_URL}/auth`\n});\nconst initialState = {\n  token: null,\n  user: null\n};\nexport const loginHandler = createAsyncThunk('auth/login', async _ref => {\n  let {\n    loginForm,\n    setlogin,\n    dispatch\n  } = _ref;\n  try {\n    dispatch(openAlert({\n      message: 'Authenticated user..',\n      variant: 'bg-blue-50',\n      textVariant: 'text-blue-500'\n    }));\n    const {\n      data\n    } = await API.post('/login', loginForm);\n    if (data) {\n      setlogin(false);\n      return data;\n    }\n  } catch (err) {\n    const {\n      response: {\n        data\n      }\n    } = err;\n    dispatch(openAlert({\n      message: data.message,\n      variant: 'bg-blue-50',\n      textVariant: 'text-blue-500'\n    }));\n  }\n});\nexport const registerHandler = createAsyncThunk('auth/register', async _ref2 => {\n  let {\n    registerForm\n  } = _ref2;\n  try {\n    const {\n      data\n    } = await API.post('/login', registerForm);\n    if (data) {\n      return data;\n    }\n  } catch (err) {\n    return null;\n  }\n});\nconst AuthSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(loginHandler.fulfilled, (state, _ref3) => {\n      let {\n        payload\n      } = _ref3;\n      state.token = payload;\n      state.user = payload ? JWTDecode(payload) : null;\n      localStorage.setItem('token', JSON.stringify(state.token));\n      return state;\n    });\n    builder.addCase(registerHandler.fulfilled, (state, _ref4) => {\n      let {\n        payload\n      } = _ref4;\n      state.token = payload;\n      state.user = payload ? JWTDecode(payload) : null;\n      localStorage.setItem('token', JSON.stringify(state.token));\n      return state;\n    });\n  }\n});\nexport default AuthSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","JWTDecode","openAlert","axios","API","create","baseURL","process","env","REACT_APP_BASE_API_URL","initialState","token","user","loginHandler","loginForm","setlogin","dispatch","message","variant","textVariant","data","post","err","response","registerHandler","registerForm","AuthSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","payload","localStorage","setItem","JSON","stringify","reducer"],"sources":["D:/programmer/project-pl/inspobox/frontend/src/slices/AuthSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\r\nimport JWTDecode from 'jwt-decode';\r\nimport { openAlert } from \"./AlertSlice\";\r\nimport axios from \"axios\";\r\n\r\nconst API = axios.create({\r\n   baseURL:`${process.env.REACT_APP_BASE_API_URL}/auth`\r\n});\r\n\r\nconst initialState = {\r\n    token:null,\r\n    user:null, \r\n}\r\n\r\nexport const loginHandler = createAsyncThunk('auth/login' , async ({ loginForm,setlogin,dispatch }) => {\r\n    try {\r\n       dispatch(openAlert({\r\n          message:'Authenticated user..',\r\n          variant:'bg-blue-50',\r\n          textVariant:'text-blue-500'\r\n       }));\r\n\r\n        const { data } = await API.post('/login' , loginForm);\r\n        if(data) {\r\n            setlogin(false);\r\n            return data;\r\n        }\r\n\r\n    } catch(err) {\r\n        const { response:{ data} } = err;\r\n        dispatch(openAlert({\r\n            message:data.message,\r\n            variant:'bg-blue-50',\r\n            textVariant:'text-blue-500'\r\n         }));\r\n    }\r\n});\r\n\r\nexport const registerHandler = createAsyncThunk('auth/register' , async ({ registerForm }) => {\r\n     try {\r\n        \r\n        const { data } = await API.post('/login' , registerForm);\r\n        if(data) {\r\n            return data;\r\n        }\r\n\r\n     }catch(err) {\r\n        return null;\r\n     }\r\n});\r\n\r\nconst AuthSlice = createSlice({\r\n    name:'auth', \r\n    initialState,\r\n    reducers: {\r\n\r\n    },\r\n    extraReducers:(builder)=> {\r\n       builder.addCase(loginHandler.fulfilled, (state, { payload }) => {\r\n          state.token = payload;\r\n          state.user = payload ? JWTDecode(payload) : null;\r\n\r\n          localStorage.setItem('token' , JSON.stringify(state.token));\r\n          return state;\r\n       });\r\n\r\n       builder.addCase(registerHandler.fulfilled, (state,  { payload }) => {\r\n        state.token = payload;\r\n        state.user = payload ? JWTDecode(payload) : null;\r\n\r\n        localStorage.setItem('token' , JSON.stringify(state.token));\r\n        return state;\r\n       });\r\n    }\r\n});\r\n\r\nexport default AuthSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}